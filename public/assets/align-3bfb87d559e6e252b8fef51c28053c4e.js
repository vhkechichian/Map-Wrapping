function addImageTo(a,e){thumburl="/maps/thumb/"+e,jQuery("#"+a).html("<img src = '"+thumburl+"' />")}function serialiseStuff(){if(frm=document.getElementById("align_form"),finalPos=jQuery("#sortable").sortable("toArray"),gridArray.length<=1)return alert("Sorry, but there should be at least two maps selected"),!1;origSrc=gridArray[0].place.substring(gridArray[0].place.length-1),origDst=gridArray[1].place.substring(gridArray[1].place.length-1),finalSrc=jQuery.inArray("place_"+(origSrc-0),finalPos)+1,finalDst=jQuery.inArray("place_"+(origDst-0),finalPos)+1;var a=finalSrc-finalDst;switch((2==finalSrc&&3==finalDst||3==finalSrc&&2==finalDst)&&(a=4),a){case-1:align="east";break;case 1:align="west";break;case 2:align="north";break;case-2:align="south";break;default:align="other"}return"other"==align?(alert("Sorry, only horizontal and vertical alignment are available at the moment"),!1):(document.getElementById("align").value=align,frm.destmap.value!=frm.srcmap.value&&frm.destmap.value.length>0?!0:(alert("Sorry, either no map was selected, or the same map number was entered"),!1))}var gridArray=new Array,currentPlaceholder,map=jQuery("#mapid");jQuery(function(){place=new Object,place.place="place_4",place.map=map_id,gridArray.push(place),addImageTo(place.place,map_id),jQuery("#sortable").sortable({placeholder:"ui-state-highlight",cancel:".ui-state-disabled"}),jQuery("#sortable").disableSelection(),jQuery("a.add_map").click(function(a){return currentPlaceholder=a.target.parentNode.id,jQuery("#dialog").dialog("open"),!1}).hover(function(){jQuery(this).addClass("ui-state-hover")},function(){jQuery(this).removeClass("ui-state-hover")}).mousedown(function(){jQuery(this).addClass("ui-state-active")}).mouseup(function(){jQuery(this).removeClass("ui-state-active")}),jQuery("#align-accordian").accordion({autoHeight:!1,collapsible:!0}),jQuery("#align-accordian button").click(function(a){jQuery("#mapid").val(a.target.id),jQuery("#dialog").dialog("option","buttons")["Add Map"].apply(jQuery("#dialog"))}),jQuery("#dialog").dialog({bgiframe:!0,autoOpen:!1,height:500,width:600,modal:!0,buttons:{"Add Map":function(){var a=jQuery("#mapid").val();jQuery("a.add_map").hide(),place=new Object,place.place=currentPlaceholder,place.map=a,gridArray.push(place),addImageTo(currentPlaceholder,a),jQuery(this).dialog("close"),jQuery("#srcmap").val(a)},Cancel:function(){jQuery(this).dialog("close")}},close:function(){}})});